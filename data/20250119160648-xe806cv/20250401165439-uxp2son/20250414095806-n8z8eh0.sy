{"ID":"20250414095806-n8z8eh0","Spec":"1","Type":"NodeDocument","Properties":{"id":"20250414095806-n8z8eh0","title":"类型推导","type":"doc","updated":"20250414095913"},"Children":[{"ID":"20250414095839-k9se6nm","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20250414095839-k9se6nm","updated":"20250414095913"},"Children":[{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"template"},{"Type":"NodeText","Data":"​\u0026"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"auto"},{"Type":"NodeText","Data":"​ \u0026 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"decltype"},{"Type":"NodeText","Data":"​"}]},{"ID":"20250414095839-h03460r","Type":"NodeList","ListData":{},"Properties":{"id":"20250414095839-h03460r","updated":"20250414095839"},"Children":[{"ID":"20250414095839-aaa5fll","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250414095839-aaa5fll","updated":"20250414095839"},"Children":[{"ID":"20250414095839-sbm23sw","Type":"NodeParagraph","Properties":{"id":"20250414095839-sbm23sw","updated":"20250414095839"},"Children":[{"Type":"NodeText","Data":"模板类型推导"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"template\u0026lt;typename T\u0026gt; void f(ParamType param); f(expr);"},{"Type":"NodeText","Data":"​"}]},{"ID":"20250414095839-aoedsgg","Type":"NodeList","ListData":{},"Properties":{"id":"20250414095839-aoedsgg","updated":"20250414095839"},"Children":[{"ID":"20250414095839-7i2f4tb","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250414095839-7i2f4tb","updated":"20250414095839"},"Children":[{"ID":"20250414095839-1t0eu1v","Type":"NodeParagraph","Properties":{"id":"20250414095839-1t0eu1v","updated":"20250414095839"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ParamType"},{"Type":"NodeText","Data":"​是一个指针或引用，但不是通用引用"}]},{"ID":"20250414095839-yycffjr","Type":"NodeParagraph","Properties":{"id":"20250414095839-yycffjr","updated":"20250414095839"},"Children":[{"Type":"NodeText","Data":"对象的常量性"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"const ness"},{"Type":"NodeText","Data":"​会被保留为"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"T"},{"Type":"NodeText","Data":"​的一部分"}]},{"ID":"20250414095839-tszokrm","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20250414095839-tszokrm","updated":"20250414095839"},"Children":[{"ID":"20250414095839-yr4c95c","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"MS4=","Num":1},"Properties":{"id":"20250414095839-yr4c95c","updated":"20250414095839"},"Children":[{"ID":"20250414095839-6e2890v","Type":"NodeParagraph","Properties":{"id":"20250414095839-6e2890v","updated":"20250414095839"},"Children":[{"Type":"NodeText","Data":"如果"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"expr"},{"Type":"NodeText","Data":"​的类型是一个引用，忽略引用部分"}]}]},{"ID":"20250414095839-nu3293j","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"Mi4=","Num":2},"Properties":{"id":"20250414095839-nu3293j","updated":"20250414095839"},"Children":[{"ID":"20250414095839-sjnzcd7","Type":"NodeParagraph","Properties":{"id":"20250414095839-sjnzcd7","updated":"20250414095839"},"Children":[{"Type":"NodeText","Data":"然后"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"expr"},{"Type":"NodeText","Data":"​的类型与"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ParamType"},{"Type":"NodeText","Data":"​进行模式匹配来决定"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"T"},{"Type":"NodeText","Data":"​"}]}]}]}]}]},{"ID":"20250414095839-mba0s14","Type":"NodeList","ListData":{},"Properties":{"id":"20250414095839-mba0s14","updated":"20250414095839"},"Children":[{"ID":"20250414095839-ofsgltw","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250414095839-ofsgltw","updated":"20250414095839"},"Children":[{"ID":"20250414095839-wot4lyl","Type":"NodeParagraph","Properties":{"id":"20250414095839-wot4lyl","updated":"20250414095839"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ParamType"},{"Type":"NodeText","Data":"​是一个通用引用"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"template\u0026lt;typename T\u0026gt; void f(T\u0026amp;\u0026amp; param);"},{"Type":"NodeText","Data":"​"}]},{"ID":"20250414095839-i5yheew","Type":"NodeList","ListData":{},"Properties":{"id":"20250414095839-i5yheew","updated":"20250414095839"},"Children":[{"ID":"20250414095839-v5cii9r","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250414095839-v5cii9r","updated":"20250414095839"},"Children":[{"ID":"20250414095839-k88qwk7","Type":"NodeParagraph","Properties":{"id":"20250414095839-k88qwk7","updated":"20250414095839"},"Children":[{"Type":"NodeText","Data":"如果"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"expr"},{"Type":"NodeText","Data":"​是左值，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"T"},{"Type":"NodeText","Data":"​和"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ParamType"},{"Type":"NodeText","Data":"​都会被推导为左值引用"}]},{"ID":"20250414095839-sjlr8ll","Type":"NodeList","ListData":{},"Properties":{"id":"20250414095839-sjlr8ll","updated":"20250414095839"},"Children":[{"ID":"20250414095839-wbaeven","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250414095839-wbaeven","updated":"20250414095839"},"Children":[{"ID":"20250414095839-hsq0kw4","Type":"NodeParagraph","Properties":{"id":"20250414095839-hsq0kw4","updated":"20250414095839"},"Children":[{"Type":"NodeText","Data":"这非常不寻常，这是模板类型推导中唯一一种"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"T"},{"Type":"NodeText","Data":"​被推导为引用的情况"}]}]},{"ID":"20250414095839-tr1ifqa","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250414095839-tr1ifqa","updated":"20250414095839"},"Children":[{"ID":"20250414095839-abyswaz","Type":"NodeParagraph","Properties":{"id":"20250414095839-abyswaz","updated":"20250414095839"},"Children":[{"Type":"NodeText","Data":"虽然"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ParamType"},{"Type":"NodeText","Data":"​被声明为右值引用类型，但是最后推导的结果是左值引用"}]}]}]}]},{"ID":"20250414095839-acswsw7","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250414095839-acswsw7","updated":"20250414095839"},"Children":[{"ID":"20250414095839-n0smaph","Type":"NodeParagraph","Properties":{"id":"20250414095839-n0smaph","updated":"20250414095839"},"Children":[{"Type":"NodeText","Data":"如果"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"expr"},{"Type":"NodeText","Data":"​是右值，就使用正常的推导规则"}]}]}]}]},{"ID":"20250414095839-a3z0sdz","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250414095839-a3z0sdz","updated":"20250414095839"},"Children":[{"ID":"20250414095839-fxvjndl","Type":"NodeParagraph","Properties":{"id":"20250414095839-fxvjndl","updated":"20250414095839"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ParamType"},{"Type":"NodeText","Data":"​既不是指针也不是引用，pass-by-value值拷贝，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"template\u0026lt;typename T\u0026gt; void f(T param);"},{"Type":"NodeText","Data":"​"}]},{"ID":"20250414095839-3vkqdr0","Type":"NodeList","ListData":{},"Properties":{"id":"20250414095839-3vkqdr0","updated":"20250414095839"},"Children":[{"ID":"20250414095839-ymx63em","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250414095839-ymx63em","updated":"20250414095839"},"Children":[{"ID":"20250414095839-xh4io6y","Type":"NodeParagraph","Properties":{"id":"20250414095839-xh4io6y","updated":"20250414095839"},"Children":[{"Type":"NodeText","Data":"如果"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"expr"},{"Type":"NodeText","Data":"​的类型是一个引用，忽略这个引用部分"}]}]},{"ID":"20250414095839-0u4wiik","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250414095839-0u4wiik","updated":"20250414095839"},"Children":[{"ID":"20250414095839-rvpnasp","Type":"NodeParagraph","Properties":{"id":"20250414095839-rvpnasp","updated":"20250414095839"},"Children":[{"Type":"NodeText","Data":"忽略"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"expr"},{"Type":"NodeText","Data":"​的引用性（reference-ness）之后，忽略expr的const/volatile，如果是指针，指向数据的"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"const ness"},{"Type":"NodeText","Data":"​会被保留"}]}]}]}]},{"ID":"20250414095839-o4829vu","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250414095839-o4829vu","updated":"20250414095839"},"Children":[{"ID":"20250414095839-zaq7m3w","Type":"NodeParagraph","Properties":{"id":"20250414095839-zaq7m3w","updated":"20250414095839"},"Children":[{"Type":"NodeText","Data":"数组/函数实参"}]},{"ID":"20250414095839-hvujvfb","Type":"NodeList","ListData":{},"Properties":{"id":"20250414095839-hvujvfb","updated":"20250414095839"},"Children":[{"ID":"20250414095839-lqioy0z","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250414095839-lqioy0z","updated":"20250414095839"},"Children":[{"ID":"20250414095839-7w0d3hs","Type":"NodeParagraph","Properties":{"id":"20250414095839-7w0d3hs","updated":"20250414095839"},"Children":[{"Type":"NodeText","Data":"数组、函数会退化为指针"}]}]},{"ID":"20250414095839-yau01io","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250414095839-yau01io","updated":"20250414095839"},"Children":[{"ID":"20250414095839-16gu1k2","Type":"NodeParagraph","Properties":{"id":"20250414095839-16gu1k2","updated":"20250414095839"},"Children":[{"Type":"NodeText","Data":"传引用的时候"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"template\u0026lt;typename T\u0026gt; void f(T\u0026amp; param);"},{"Type":"NodeText","Data":"​，形参会推导为数组"}]}]}]}]},{"ID":"20250414095839-pzcfmjg","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250414095839-pzcfmjg","updated":"20250414095839"},"Children":[{"ID":"20250414095839-pqredbf","Type":"NodeParagraph","Properties":{"id":"20250414095839-pqredbf","updated":"20250414095839"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"auto"},{"Type":"NodeText","Data":"​与模板推理的唯一区别，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"auto"},{"Type":"NodeText","Data":"​类型推导假定花括号初始化代表"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"std::initializer_list"},{"Type":"NodeText","Data":"​，而模板不能推导花括号，C++14中，auto做函数返回值类型、"},{"Type":"NodeTextMark","TextMarkType":"em","TextMarkTextContent":"lambda"},{"Type":"NodeText","Data":"函数形参时，也不能推导花括号，这里用的是模板类型推导方案"}]}]},{"ID":"20250414095839-qt6sdhq","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250414095839-qt6sdhq","updated":"20250414095839"},"Children":[{"ID":"20250414095839-wwxyoho","Type":"NodeParagraph","Properties":{"id":"20250414095839-wwxyoho","updated":"20250414095839"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"decltype"},{"Type":"NodeText","Data":"​"}]}]}]}]}]}]}